
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../examples/hierarchical/">
      
      
        <link rel="next" href="../hierarchical_prophet/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.14">
    
    
      
        <title>Prophet - Prophetverse</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.10ba22f1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#univariate-prophet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Prophetverse" class="md-header__button md-logo" aria-label="Prophetverse" data-md-component="logo">
      
  <img src="../../../static/logo-removebg.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prophetverse
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Prophet
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/felipeangelimvieira/prophetverse" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Prophetverse" class="md-nav__button md-logo" aria-label="Prophetverse" data-md-component="logo">
      
  <img src="../../../static/logo-removebg.png" alt="logo">

    </a>
    Prophetverse
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/felipeangelimvieira/prophetverse" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/univariate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Univariate timeseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/hierarchical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hierarchical timeseries
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sktime
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Sktime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Prophet
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Prophet
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prophetverse.sktime.univariate" class="md-nav__link">
    <span class="md-ellipsis">
      univariate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prophetverse.sktime.univariate.Prophet" class="md-nav__link">
    <span class="md-ellipsis">
      Prophet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prophet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prophetverse.sktime.univariate.Prophet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hierarchical_prophet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hierarchical Prophet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/inference_engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inference Engine
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exogenous Effects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prophetverse.sktime.univariate" class="md-nav__link">
    <span class="md-ellipsis">
      univariate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prophetverse.sktime.univariate.Prophet" class="md-nav__link">
    <span class="md-ellipsis">
      Prophet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prophet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prophetverse.sktime.univariate.Prophet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="univariate-prophet">Univariate Prophet</h1>


<div class="doc doc-object doc-module">



<a id="prophetverse.sktime.univariate"></a>
  <div class="doc doc-contents first">
  
      <p>Univariate Prophet model</p>
<p>This module implements the Univariate Prophet model, similar to the one implemented in the <code>prophet</code> library.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="prophetverse.sktime.univariate.Prophet" class="doc doc-heading">
          <code>Prophet</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="prophetverse.sktime.base.ExogenousEffectMixin">ExogenousEffectMixin</span></code>, <code><span title="prophetverse.sktime.base.BaseBayesianForecaster">BaseBayesianForecaster</span></code></p>

  
      <p>Univariate Prophet model, similar to the one implemented in the <code>prophet</code> library.</p>
<p>The main difference between the mathematical model here and from the original one is the
logistic trend. Here, another parametrization is considered, and the capacity is not
passed as input, but inferred from the data.</p>
<p>With respect to API, this one follows sktime convention where all hiperparameters are passed during
<strong>init</strong>, and uses <code>changepoint_interval</code> instead of <code>n_changepoints</code> to set the changepoints. There's no
weekly_seasonality/yearly_seasonality, but instead, the user can pass a <code>feature_transformer</code> that
will be used to generate the fourier terms. The same for holidays.</p>
<p>This model accepts configurations where each exogenous variable has a different function relating it to its additive
effect on the time series. One can, for example, set different priors for a group of feature, or use a Hill function
to model the effect of a feature.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>changepoint_interval</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of points between each potential changepoint.</p>
            </div>
          </td>
          <td>
                <code>25</code>
          </td>
        </tr>
        <tr>
          <td><code>changepoint_range</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Proportion of the history in which trend changepoints will be estimated. 
                       If a float between 0 and 1, the range will be that proportion of the history. 
                       If an int, the range will be that number of points. A negative int indicates number of points
                       counting from the end of the history.</p>
            </div>
          </td>
          <td>
                <code>0.8</code>
          </td>
        </tr>
        <tr>
          <td><code>changepoint_prior_scale</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter controlling the flexibility of the automatic changepoint selection.</p>
            </div>
          </td>
          <td>
                <code>0.001</code>
          </td>
        </tr>
        <tr>
          <td><code>feature_transformer</code></td>
          <td>
                <code><span title="sktime.transformations.base.BaseTransformer">BaseTransformer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Transformer object to generate Fourier terms, holiday or other features. Should be a sktime's Transformer</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>capacity_prior_scale</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Scale parameter for the prior distribution of the capacity.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>capacity_prior_loc</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Location parameter for the prior distribution of the capacity.</p>
            </div>
          </td>
          <td>
                <code>1.1</code>
          </td>
        </tr>
        <tr>
          <td><code>noise_scale</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Scale parameter for the observation noise.</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>trend</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of trend to use. Can be "linear" or "logistic".</p>
            </div>
          </td>
          <td>
                <code>&#39;linear&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mcmc_samples</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of MCMC samples to draw.</p>
            </div>
          </td>
          <td>
                <code>2000</code>
          </td>
        </tr>
        <tr>
          <td><code>mcmc_warmup</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of MCMC warmup steps.</p>
            </div>
          </td>
          <td>
                <code>200</code>
          </td>
        </tr>
        <tr>
          <td><code>mcmc_chains</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of MCMC chains to run in parallel.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>inference_method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Inference method to use. Can be "mcmc" or "map".</p>
            </div>
          </td>
          <td>
                <code>&#39;map&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>optimizer_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the optimizer to use for variational inference.</p>
            </div>
          </td>
          <td>
                <code>&#39;Adam&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>optimizer_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments to pass to the optimizer.</p>
            </div>
          </td>
          <td>
                <code>{&#39;step_size&#39;: 0.0001}</code>
          </td>
        </tr>
        <tr>
          <td><code>optimizer_steps</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of optimization steps to perform for variational inference.</p>
            </div>
          </td>
          <td>
                <code>100000</code>
          </td>
        </tr>
        <tr>
          <td><code>exogenous_effects</code></td>
          <td>
                <code>List[AbstractEffect]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list defining the exogenous effects to be used in the model.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>default_effect</code></td>
          <td>
                <code>AbstractEffect</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The default effect to be used when no effect is specified for a variable.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>default_exogenous_prior</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default prior distribution for exogenous effects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rng_key</code></td>
          <td>
                <code><span title="jax.random.PRNGKey">PRNGKey</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Random number generator key.</p>
            </div>
          </td>
          <td>
                <code><span title="jax.random.PRNGKey">PRNGKey</span>(24)</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>src/prophetverse/sktime/univariate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Prophet</span><span class="p">(</span><span class="n">ExogenousEffectMixin</span><span class="p">,</span> <span class="n">BaseBayesianForecaster</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Univariate Prophet model, similar to the one implemented in the `prophet` library.</span>

<span class="sd">    The main difference between the mathematical model here and from the original one is the</span>
<span class="sd">    logistic trend. Here, another parametrization is considered, and the capacity is not</span>
<span class="sd">    passed as input, but inferred from the data.</span>

<span class="sd">    With respect to API, this one follows sktime convention where all hiperparameters are passed during</span>
<span class="sd">    __init__, and uses `changepoint_interval` instead of `n_changepoints` to set the changepoints. There&#39;s no</span>
<span class="sd">    weekly_seasonality/yearly_seasonality, but instead, the user can pass a `feature_transformer` that</span>
<span class="sd">    will be used to generate the fourier terms. The same for holidays.</span>

<span class="sd">    This model accepts configurations where each exogenous variable has a different function relating it to its additive</span>
<span class="sd">    effect on the time series. One can, for example, set different priors for a group of feature, or use a Hill function</span>
<span class="sd">    to model the effect of a feature.</span>


<span class="sd">    Args:</span>
<span class="sd">        changepoint_interval (int): The number of points between each potential changepoint.</span>
<span class="sd">        changepoint_range (float): Proportion of the history in which trend changepoints will be estimated. </span>
<span class="sd">                                   If a float between 0 and 1, the range will be that proportion of the history. </span>
<span class="sd">                                   If an int, the range will be that number of points. A negative int indicates number of points</span>
<span class="sd">                                   counting from the end of the history.</span>
<span class="sd">        changepoint_prior_scale (float): Parameter controlling the flexibility of the automatic changepoint selection.</span>
<span class="sd">        feature_transformer (BaseTransformer): Transformer object to generate Fourier terms, holiday or other features. Should be a sktime&#39;s Transformer</span>
<span class="sd">        capacity_prior_scale (float): Scale parameter for the prior distribution of the capacity.</span>
<span class="sd">        capacity_prior_loc (float): Location parameter for the prior distribution of the capacity.</span>
<span class="sd">        noise_scale (float): Scale parameter for the observation noise.</span>
<span class="sd">        trend (str): Type of trend to use. Can be &quot;linear&quot; or &quot;logistic&quot;.</span>
<span class="sd">        mcmc_samples (int): Number of MCMC samples to draw.</span>
<span class="sd">        mcmc_warmup (int): Number of MCMC warmup steps.</span>
<span class="sd">        mcmc_chains (int): Number of MCMC chains to run in parallel.</span>
<span class="sd">        inference_method (str): Inference method to use. Can be &quot;mcmc&quot; or &quot;map&quot;.</span>
<span class="sd">        optimizer_name (str): Name of the optimizer to use for variational inference.</span>
<span class="sd">        optimizer_kwargs (dict): Additional keyword arguments to pass to the optimizer.</span>
<span class="sd">        optimizer_steps (int): Number of optimization steps to perform for variational inference.</span>
<span class="sd">        exogenous_effects (List[AbstractEffect]): A list defining the exogenous effects to be used in the model.</span>
<span class="sd">        default_effect (AbstractEffect): The default effect to be used when no effect is specified for a variable.</span>
<span class="sd">        default_exogenous_prior (tuple): Default prior distribution for exogenous effects.</span>
<span class="sd">        rng_key (jax.random.PRNGKey): Random number generator key.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_tags</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;requires-fh-in-fit&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;y_inner_mtype&quot;</span><span class="p">:</span> <span class="s2">&quot;pd.DataFrame&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">changepoint_interval</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">changepoint_range</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
        <span class="n">feature_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">capacity_prior_scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">capacity_prior_loc</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
        <span class="n">noise_scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
        <span class="n">mcmc_samples</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
        <span class="n">mcmc_warmup</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">mcmc_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">inference_method</span><span class="o">=</span><span class="s2">&quot;map&quot;</span><span class="p">,</span>
        <span class="n">optimizer_name</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span>
        <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;step_size&quot;</span> <span class="p">:</span> <span class="mf">1e-4</span><span class="p">},</span>
        <span class="n">optimizer_steps</span><span class="o">=</span><span class="mi">100_000</span><span class="p">,</span>
        <span class="n">exogenous_effects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">default_effect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the Prophet model.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_interval</span> <span class="o">=</span> <span class="n">changepoint_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_range</span> <span class="o">=</span> <span class="n">changepoint_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_prior_scale</span> <span class="o">=</span> <span class="n">changepoint_prior_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise_scale</span> <span class="o">=</span> <span class="n">noise_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_transformer</span> <span class="o">=</span> <span class="n">feature_transformer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_scale</span> <span class="o">=</span> <span class="n">capacity_prior_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_loc</span> <span class="o">=</span> <span class="n">capacity_prior_loc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trend</span> <span class="o">=</span> <span class="n">trend</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span><span class="p">,</span>
            <span class="c1"># ExogenousEffectMixin</span>
            <span class="n">default_effect</span><span class="o">=</span><span class="n">default_effect</span><span class="p">,</span>
            <span class="n">exogenous_effects</span><span class="o">=</span><span class="n">exogenous_effects</span><span class="p">,</span>
            <span class="c1"># BaseBayesianForecaster</span>
            <span class="n">inference_method</span><span class="o">=</span><span class="n">inference_method</span><span class="p">,</span>
            <span class="n">mcmc_samples</span><span class="o">=</span><span class="n">mcmc_samples</span><span class="p">,</span>
            <span class="n">mcmc_warmup</span><span class="o">=</span><span class="n">mcmc_warmup</span><span class="p">,</span>
            <span class="n">mcmc_chains</span><span class="o">=</span><span class="n">mcmc_chains</span><span class="p">,</span>
            <span class="n">optimizer_name</span><span class="o">=</span><span class="n">optimizer_name</span><span class="p">,</span>
            <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="n">optimizer_kwargs</span><span class="p">,</span>
            <span class="n">optimizer_steps</span><span class="o">=</span><span class="n">optimizer_steps</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_hyperparams</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the hyperparameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_interval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;changepoint_interval must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_prior_scale</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;changepoint_prior_scale must be greater than 0.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_scale</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;noise_scale must be greater than 0.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_scale</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;capacity_prior_scale must be greater than 0.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_loc</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;capacity_prior_loc must be greater than 0.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;logistic&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;trend must be either &quot;linear&quot; or &quot;logistic&quot;.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_fit_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">fh</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepares the data for the Numpyro model.</span>

<span class="sd">        Args:</span>
<span class="sd">            y (pd.DataFrame): Time series data.</span>
<span class="sd">            X (pd.DataFrame): Exogenous variables.</span>
<span class="sd">            fh (ForecastingHorizon): Forecasting horizon.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary of data for the Numpyro model.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_time_scale</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="c1">## Changepoints and trend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_changepoints_t</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_scaled_timearray</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">changepoint_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_changepoint_matrix</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">trend_sample_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_trend_sample_func</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>

        <span class="c1">## Exogenous features</span>

        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_transformer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_exogenous</span> <span class="o">=</span> <span class="o">~</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">empty</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_custom_effects</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">exogenous_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_exogenous_data_array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="n">y_array</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1">## Inputs that also are used in predict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_and_predict_data_</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;init_trend_params&quot;</span><span class="p">:</span> <span class="n">trend_sample_func</span><span class="p">,</span>
            <span class="s2">&quot;trend_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span>
            <span class="s2">&quot;exogenous_effects&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">exogenous_effect_dict</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_exogenous</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_scaled_timearray</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y_array</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">exogenous_data</span><span class="p">,</span>
            <span class="s2">&quot;changepoint_matrix&quot;</span><span class="p">:</span> <span class="n">changepoint_matrix</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_and_predict_data_</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">inputs</span>

    <span class="k">def</span> <span class="nf">_get_trend_sample_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Get a function that samples the trend parameters.</span>

<span class="sd">        This function may change in the future. Currently, the model function receives a function to get the changepoint coefficients.</span>
<span class="sd">        This function is passed to the model as a partial function, with the changepoint coefficients as a parameter</span>

<span class="sd">        Args:</span>
<span class="sd">            y (pd.DataFrame): Time series data.</span>
<span class="sd">            X (pd.DataFrame): Exogenous variables.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Callable: Function that samples the trend parameters.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_scaled_timearray</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">distributions</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">changepoints_loc</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changepoint_t</span><span class="p">))</span>
        <span class="n">detrender</span> <span class="o">=</span> <span class="n">Detrender</span><span class="p">()</span>
        <span class="n">trend</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">detrender</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trend</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>

            <span class="n">linear_global_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">trend</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">t_scaled</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">changepoints_loc</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">linear_global_rate</span><span class="p">)</span>

            <span class="n">distributions</span><span class="p">[</span><span class="s2">&quot;changepoint_coefficients&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span>
                <span class="n">changepoints_loc</span><span class="p">,</span>
                <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changepoint_t</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changepoint_prior_scale</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="n">distributions</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
                <span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">linear_global_rate</span> <span class="o">*</span> <span class="n">t_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="mf">0.1</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trend</span> <span class="o">==</span> <span class="s2">&quot;logistic&quot;</span><span class="p">:</span>

            <span class="n">linear_global_rate</span><span class="p">,</span> <span class="n">timeoffset</span> <span class="o">=</span> <span class="n">suggest_logistic_rate_and_offset</span><span class="p">(</span>
                <span class="n">t_scaled</span><span class="p">,</span>
                <span class="n">trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                <span class="n">capacities</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_loc</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">linear_global_rate</span> <span class="o">=</span> <span class="n">linear_global_rate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">timeoffset</span> <span class="o">=</span> <span class="n">timeoffset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">changepoints_loc</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">linear_global_rate</span><span class="p">)</span>

            <span class="n">changepoint_coefficients_distribution</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span>
                <span class="n">changepoints_loc</span><span class="p">,</span>
                <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changepoint_t</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_prior_scale</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">distributions</span><span class="p">[</span><span class="s2">&quot;changepoint_coefficients&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">changepoint_coefficients_distribution</span>
            <span class="p">)</span>

            <span class="n">distributions</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">timeoffset</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

            <span class="n">distributions</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">TransformedDistribution</span><span class="p">(</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_scale</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">AffineTransform</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="n">distributions</span><span class="p">[</span><span class="s2">&quot;std_observation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_scale</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">init_trend_params</span><span class="p">(</span><span class="n">distributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">init_params</span><span class="p">(</span><span class="n">distributions</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">init_trend_params</span><span class="p">,</span> <span class="n">distributions</span><span class="o">=</span><span class="n">distributions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_time_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the scales for the time series data.</span>

<span class="sd">        Args:</span>
<span class="sd">            y (pd.DataFrame): Time series data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set time scale</span>
        <span class="n">t_days</span> <span class="o">=</span> <span class="n">convert_index_to_days_since_epoch</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">t_scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_days</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">t_days</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_start</span> <span class="o">=</span> <span class="n">t_days</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_scale</span>

    <span class="k">def</span> <span class="nf">_index_to_scaled_timearray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales the index values.</span>

<span class="sd">        Args:</span>
<span class="sd">            idx (pd.Index): Pandas Index object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: Scaled index values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_days</span> <span class="o">=</span> <span class="n">convert_index_to_days_since_epoch</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">t_days</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_scale</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_start</span>

    <span class="k">def</span> <span class="nf">_set_changepoints_t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the array of changepoint times.</span>

<span class="sd">        This function has the colateral effect of setting the attribute `_changepoint_t` in the class.</span>

<span class="sd">        Args:</span>
<span class="sd">            y (pd.DataFrame): Time series data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">t_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_scaled_timearray</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_changepoint_t</span> <span class="o">=</span> <span class="n">get_changepoint_timeindexes</span><span class="p">(</span>
            <span class="n">t</span><span class="o">=</span><span class="n">t_scaled</span><span class="p">,</span>
            <span class="n">changepoint_interval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">changepoint_interval</span><span class="p">,</span>
            <span class="n">changepoint_range</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">changepoint_range</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_changepoint_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the changepoint coefficient matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            t (jnp.ndarray): Array of time values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            jnp.ndarray: Changepoint coefficient matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">get_changepoint_matrix</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changepoint_t</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_predict_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">fh</span><span class="p">:</span> <span class="n">ForecastingHorizon</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepares the data for making predictions.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (pd.DataFrame): Exogenous variables.</span>
<span class="sd">            fh (ForecastingHorizon): Forecasting horizon.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary of data for the Numpyro model.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fh_dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_to_index</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
        <span class="n">fh_as_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fh_dates</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()))</span>

        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_scaled_timearray</span><span class="p">(</span><span class="n">fh_as_index</span><span class="p">)</span>
        <span class="n">changepoint_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_changepoint_matrix</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">fh_as_index</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_transformer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="n">exogenous_data</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_exogenous_data_array</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fh_as_index</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_exogenous</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
            <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">exogenous_data</span><span class="p">,</span>
            <span class="n">changepoint_matrix</span><span class="o">=</span><span class="n">changepoint_matrix</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_and_predict_data_</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="prophetverse.sktime.univariate.Prophet.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">changepoint_interval</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">changepoint_range</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">feature_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">capacity_prior_scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">capacity_prior_loc</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">noise_scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">mcmc_samples</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">mcmc_warmup</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">mcmc_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">inference_method</span><span class="o">=</span><span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="n">optimizer_name</span><span class="o">=</span><span class="s1">&#39;Adam&#39;</span><span class="p">,</span> <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;step_size&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">},</span> <span class="n">optimizer_steps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">exogenous_effects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_effect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rng_key</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializes the Prophet model.</p>

          <details class="quote">
            <summary>Source code in <code>src/prophetverse/sktime/univariate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">changepoint_interval</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">changepoint_range</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">feature_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">capacity_prior_scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">capacity_prior_loc</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
    <span class="n">noise_scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
    <span class="n">mcmc_samples</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="n">mcmc_warmup</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">mcmc_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">inference_method</span><span class="o">=</span><span class="s2">&quot;map&quot;</span><span class="p">,</span>
    <span class="n">optimizer_name</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span>
    <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;step_size&quot;</span> <span class="p">:</span> <span class="mf">1e-4</span><span class="p">},</span>
    <span class="n">optimizer_steps</span><span class="o">=</span><span class="mi">100_000</span><span class="p">,</span>
    <span class="n">exogenous_effects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">default_effect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">rng_key</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the Prophet model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_interval</span> <span class="o">=</span> <span class="n">changepoint_interval</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_range</span> <span class="o">=</span> <span class="n">changepoint_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">changepoint_prior_scale</span> <span class="o">=</span> <span class="n">changepoint_prior_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise_scale</span> <span class="o">=</span> <span class="n">noise_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">feature_transformer</span> <span class="o">=</span> <span class="n">feature_transformer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_scale</span> <span class="o">=</span> <span class="n">capacity_prior_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capacity_prior_loc</span> <span class="o">=</span> <span class="n">capacity_prior_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trend</span> <span class="o">=</span> <span class="n">trend</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span><span class="p">,</span>
        <span class="c1"># ExogenousEffectMixin</span>
        <span class="n">default_effect</span><span class="o">=</span><span class="n">default_effect</span><span class="p">,</span>
        <span class="n">exogenous_effects</span><span class="o">=</span><span class="n">exogenous_effects</span><span class="p">,</span>
        <span class="c1"># BaseBayesianForecaster</span>
        <span class="n">inference_method</span><span class="o">=</span><span class="n">inference_method</span><span class="p">,</span>
        <span class="n">mcmc_samples</span><span class="o">=</span><span class="n">mcmc_samples</span><span class="p">,</span>
        <span class="n">mcmc_warmup</span><span class="o">=</span><span class="n">mcmc_warmup</span><span class="p">,</span>
        <span class="n">mcmc_chains</span><span class="o">=</span><span class="n">mcmc_chains</span><span class="p">,</span>
        <span class="n">optimizer_name</span><span class="o">=</span><span class="n">optimizer_name</span><span class="p">,</span>
        <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="n">optimizer_kwargs</span><span class="p">,</span>
        <span class="n">optimizer_steps</span><span class="o">=</span><span class="n">optimizer_steps</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_hyperparams</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>